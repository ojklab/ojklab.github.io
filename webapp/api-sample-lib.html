<html>

<body>
  <!-- HTML -->
  <div id="app">
    <p><button @click="getLibrary()">図書館（axios）</button></p>
    <p><button @click="getCheck()">貸出中（axios）</button></p>
    <p><button @click="getCheck2()">貸出中（JSONP）</button></p>
    <p v-if="apidata">{{apidata}}</p>
  </div>


  <!-- JavaScript -->
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script>
    function getJSONP(response) {
      console.log(response);
      app.apidata = response;
    }

    axios.defaults.headers.post["Content-Type"] = "application/x-www-form-urlencoded";

    var app = new Vue({
      el: '#app',
      data: {
        apidata: ''
      },
      methods: {
        getLibrary: function () {
          axios({
            method: 'GET',
            url: 'http://api.calil.jp/library',
            params: {
              // アプリケーションキー要取得 → https://calil.jp/api/dashboard/
              appkey: 'c7919894e7942f193f7322bdfcad8e01',
              pref: '兵庫県',
              format: 'JSON',
              callback: 'no'
            }
          }).then(response => {
            this.apidata = response.data;
          }).catch(error => {
            console.log(error);
          })
        },
        getCheck: function () {
          axios({
            method: 'GET',
            url: 'https://api.calil.jp/check',
            params: {
              appkey: 'c7919894e7942f193f7322bdfcad8e01',
              isbn: '4834000826',
              systemid: 'Hyogo_Pref',
              format: 'JSON',
              callback: 'no'
            }
          }).then(response => {
            this.apidata = response;
          }).catch(error => {
            console.log(error);
          })
        },
        getCheck2: function() {
          /* CORS制限をJSONPで回避する方法 */          
          let elm = document.createElement('script');
          elm.charset = 'utf-8';
          elm.src = 'https://api.calil.jp/check?appkey=c7919894e7942f193f7322bdfcad8e01&isbn=4834000826&systemid=Hyogo_Pref&callback=getJSONP';
          document.body.appendChild(elm);
        }
      }
    });
  </script>
</body>